!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("file-saver"),require("exceljs/dist/es5/exceljs.browser"),require("@angular/core")):"function"==typeof define&&define.amd?define("ngx-table-to-excel",["exports","file-saver","exceljs/dist/es5/exceljs.browser","@angular/core"],e):e(t["ngx-table-to-excel"]={},t.saveAs,t.ExcelJS,t.ng.core)}(this,function(t,r,e,a){"use strict";function o(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var a,o,n=r.call(t),l=[];try{for(;(void 0===e||0<e--)&&!(a=n.next()).done;)l.push(a.value)}catch(i){o={error:i}}finally{try{a&&!a.done&&(r=n["return"])&&r.call(n)}finally{if(o)throw o.error}}return l}function w(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t}r=r&&r.hasOwnProperty("default")?r["default"]:r,e=e&&e.hasOwnProperty("default")?e["default"]:e;var n=(l.prototype.parseDomToTable=function(r,t,e){var a,o,n,l,i,u,g="TABLE"===t.tagName;if(g){var s,c=w(t.getElementsByTagName("tr"));(s=t.getAttribute("data-cols-width"))&&(s=s.split(",").map(function(t){return parseInt(t)}));var b=[],d=r.rowCount;for(a=0;a<c.length;++a)if(i=d+a+1,u=1,"true"!==(y=c[a]).getAttribute("data-exclude")){y.getAttribute("data-height")&&(r.getRow(i).height=parseFloat(y.getAttribute("data-height")));var p=w(y.children);for(o=0;o<p.length;++o){var f=p[o];if("true"!==f.getAttribute("data-exclude")){for(var h=0;h<b.length;++h)(x=b[h]).s.c==u&&x.s.r<=i&&i<=x.e.r&&(u=x.e.c+1,h=-1);var m=r.getCell(this.getColumnAddress(u,i));if(n=parseInt(f.getAttribute("colspan"))||1,l=parseInt(f.getAttribute("rowspan"))||1,(1<n||1<l)&&b.push({s:{c:u,r:i},e:{c:u+n-1,r:i+l-1}}),u+=n,m.value=this.getValue(f,g),!e.autoStyle){var A=this.getStylesDataAttr(f);if(m.font=A.font||null,m.alignment=A.alignment||null,m.border=A.border||null,m.fill=A.fill||null,m.numFmt=A.numFmt||null,null==m.numFmt&&"string"==typeof m.value){var v=m.value.replace(/ /g,"").replace(/\,/g,"");/^(\+|\-)?\$[0-9]+(\.[0-9]{1,2})?$/.test(v)&&(m.value=m.value.replace(/[^0-9\+\-\.]/g,""),m.value=Number(m.value),m.numFmt="$#,##0.00")}}}else p.splice(o,1),o--}}else c.splice(a,1),a--;return s&&s.forEach(function(t,e){r.columns[e].width=t}),this.applyMerges(r,b),r}(s=t.getAttribute("data-cols-width"))&&(s=s.split(",").map(function(t){return parseInt(t)})),b=[],a=0;var y=t;if(i=r.rowCount+a+1,u=1,"true"===y.getAttribute("data-exclude"))return r;for(y.getAttribute("data-height")&&(r.getRow(i).height=parseFloat(y.getAttribute("data-height"))),h=0;h<b.length;++h){var x;(x=b[h]).s.c==u&&x.s.r<=i&&i<=x.e.r&&(u=x.e.c+1,h=-1)}return m=r.getCell(this.getColumnAddress(u,i)),n=parseInt(y.getAttribute("colspan"))||1,l=parseInt(y.getAttribute("rowspan"))||1,(1<n||1<l)&&b.push({s:{c:u,r:i},e:{c:u+n-1,r:i+l-1}}),u+=n,m.value=this.getValue(y,g),e.autoStyle||(A=this.getStylesDataAttr(y),m.font=A.font||null,m.alignment=A.alignment||null,m.border=A.border||null,m.fill=A.fill||null,m.numFmt=A.numFmt||null,null==m.numFmt&&"string"==typeof m.value&&(v=m.value.replace(/ /g,"").replace(/\,/g,""),/^(\+|\-)?\$[0-9]+(\.[0-9]{1,2})?$/.test(v)&&(m.value=m.value.replace(/[^0-9\+\-\.]/g,""),m.value=Number(m.value),m.numFmt="$#,##0.00"))),s&&s.forEach(function(t,e){r.columns[e].width=t}),this.applyMerges(r,b),r},l.prototype.applyMerges=function(e,t){var r=this;t.forEach(function(t){e.mergeCells(r.getExcelColumnName(t.s.c)+t.s.r+":"+r.getExcelColumnName(t.e.c)+t.e.r)})},l.prototype.getExcelColumnName=function(t){for(var e="",r=1,a=26;0<=(t-=r);r=a,a*=26)e=String.fromCharCode(Math.trunc(t%a/r)+65)+e;return e},l.prototype.getColumnAddress=function(t,e){return this.getExcelColumnName(t)+e},l.prototype.getValue=function(t,e){var r=t.getAttribute("data-t"),a=e?this.htmldecode(t.innerHTML):t.innerText;if(r){var o=void 0;switch(r){case"n":a=a.replace(/[^0-9\+\-\.]/g,""),o=Number(a);break;case"d":o=new Date(a);break;case"b":o="true"===a.toLowerCase()||"false"!==a.toLowerCase()&&Boolean(parseInt(a));break;default:o=a}return o}return t.getAttribute("data-hyperlink")?{text:a,hyperlink:t.getAttribute("data-hyperlink")}:t.getAttribute("data-error")?{error:t.getAttribute("data-error")}:a},l.prototype.htmldecode=function(t){for(var e=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","g"),t[1]]}),r=t.trim().replace(/\s+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),a=0;a<e.length;++a)r=r.replace(e[a][0],e[a][1]);return r},l.prototype.getHexArgbColor=function(t){var e=t;-1==e.indexOf("a")&&(e=e.replace(")",", 1)").replace("rgb","rgba"));var r=e.split("(")[1].split(")")[0].split(","),a=(+r[0]).toString(16),o=(+r[1]).toString(16),n=(+r[2]).toString(16);return"0"==Math.round(255*+r[3]).toString(16)?"":(1==a.length&&(a="0"+a),1==o.length&&(o="0"+o),1==n.length&&(n="0"+n),"F"+a.toUpperCase()+o.toUpperCase()+n.toUpperCase())},l.prototype.getStylesDataAttr=function(t){var e=window.getComputedStyle(t,null),r={};if(t.getAttribute("data-f-name")&&(r.name=t.getAttribute("data-f-name")),t.getAttribute("data-f-sz")&&(r.size=t.getAttribute("data-f-sz")),t.getAttribute("data-f-color"))"none"!=t.getAttribute("data-f-color")&&(r.color={argb:t.getAttribute("data-f-color")});else{var a=e.getPropertyValue("color"),o=this.getHexArgbColor(a);""!=o&&(r.color={argb:o})}"true"===t.getAttribute("data-f-bold")&&(r.bold=!0),"true"===t.getAttribute("data-f-italic")&&(r.italic=!0),"true"===t.getAttribute("data-f-underline")&&(r.underline=!0),"true"===t.getAttribute("data-f-strike")&&(r.strike=!0);var n={};t.getAttribute("data-a-h")&&(n.horizontal=t.getAttribute("data-a-h")),t.getAttribute("data-a-v")?n.vertical=t.getAttribute("data-a-v"):n.vertical="middle","false"===t.getAttribute("data-a-wrap")?n.wrapText=!1:n.wrapText=!0,t.getAttribute("data-a-text-rotation")&&(n.textRotation=t.getAttribute("data-a-text-rotation")),t.getAttribute("data-a-indent")&&(n.indent=t.getAttribute("data-a-indent")),"true"===t.getAttribute("data-a-rtl")&&(n.readingOrder="rtl");var l,i,u={top:{},left:{},bottom:{},right:{}};if(t.getAttribute("data-b-a-s")){if("none"!=t.getAttribute("data-b-a-s")){var g=t.getAttribute("data-b-a-s");u.top.style=g,u.left.style=g,u.bottom.style=g,u.right.style=g}}else u.top.style="thin",u.left.style="thin",u.bottom.style="thin",u.right.style="thin";if(t.getAttribute("data-b-a-c")){var s={argb:t.getAttribute("data-b-a-c")};u.top.color=s,u.left.color=s,u.bottom.color=s,u.right.color=s}if(t.getAttribute("data-b-t-s")&&(u.top.style=t.getAttribute("data-b-t-s"),t.getAttribute("data-b-t-c")&&(u.top.color={argb:t.getAttribute("data-b-t-c")})),t.getAttribute("data-b-l-s")&&(u.left.style=t.getAttribute("data-b-l-s"),t.getAttribute("data-b-l-c")&&(u.left.color={argb:t.getAttribute("data-b-t-c")})),t.getAttribute("data-b-b-s")&&(u.bottom.style=t.getAttribute("data-b-b-s"),t.getAttribute("data-b-b-c")&&(u.bottom.color={argb:t.getAttribute("data-b-t-c")})),t.getAttribute("data-b-r-s")&&(u.right.style=t.getAttribute("data-b-r-s"),t.getAttribute("data-b-r-c")&&(u.right.color={argb:t.getAttribute("data-b-t-c")})),t.getAttribute("data-fill-color"))"none"!=t.getAttribute("data-fill-color")&&(l={type:"pattern",pattern:"solid",fgColor:{argb:t.getAttribute("data-fill-color")}});else{var c=e.getPropertyValue("background-color"),b=this.getHexArgbColor(c);""!=b&&(l={type:"pattern",pattern:"solid",fgColor:{argb:b}})}return t.getAttribute("data-num-fmt")&&(i=t.getAttribute("data-num-fmt")),{font:r,alignment:n,border:u,fill:l,numFmt:i}},l.decorators=[{type:a.Injectable,args:[{providedIn:"root"}]}],l.ngInjectableDef=a.defineInjectable({factory:function(){return new l},token:l,providedIn:"root"}),l);function l(){}var i=(u.prototype.initWorkBook=function(){return new e.Workbook},u.prototype.initSheet=function(t,e){return t.addWorksheet(e)},u.prototype.save=function(t,e){t.xlsx.writeBuffer().then(function(t){r(new Blob([t],{type:"application/octet-stream"}),e)})},u.prototype.tableToSheet=function(t,e,r){var a=this.initSheet(t,r.sheet.name);return a=this.parser.parseDomToTable(a,e,r),t},u.prototype.tableToBook=function(t,e){var r=this.initWorkBook();return r=this.tableToSheet(r,t,e)},u.prototype.convert=function(t,e){void 0===e&&(e={}),e=Object.assign({},{name:"export.xlsx",autoStyle:!1,sheet:{name:"Sheet 1"}},e);var r=this.tableToBook(t,e);this.save(r,e.name)},u.decorators=[{type:a.Injectable,args:[{providedIn:"root"}]}],u.ctorParameters=function(){return[{type:n}]},u.ngInjectableDef=a.defineInjectable({factory:function(){return new u(a.inject(n))},token:u,providedIn:"root"}),u);function u(t){this.parser=t}var g=(s.decorators=[{type:a.NgModule,args:[{imports:[]}]}],s);function s(){}t.DomParserService=n,t.TableToExcelService=i,t.NgxTableToExcelModule=g,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-table-to-excel.umd.min.js.map